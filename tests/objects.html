<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JSW - Object Tests</title>
    <link rel="stylesheet" href="/public/style.css">
</head>
<body>
    <div class="container">
        <a href="/" class="back-link">← Back to Dashboard</a>
        <h1>Objects & Nested Structures</h1>
        <div id="app"></div>
    </div>
    <script type="module">
        import { createComplex, processComplex } from '/src/object_test.ts';
        import { createMixed, callMixed } from '/src/mixed_test.ts';

        const app = document.getElementById('app');
        function assert(condition, message) {
            const div = document.createElement('div');
            div.className = condition ? 'test-result pass' : 'test-result fail';
            div.textContent = (condition ? '✅ PASS: ' : '❌ FAIL: ') + message;
            app.appendChild(div);
        }

        try {
            const obj = createComplex(123);
            assert(obj.id === 123, `createComplex(123).id = ${obj.id}`);
            assert(obj.nested.val === 246, `createComplex(123).nested.val = ${obj.nested.val}`);
        } catch (e) { assert(false, `createComplex error: ${e.message}`); }

        try {
            const input = {
                id: 10,
                list: [1, 2],
                nested: { val: 5, fn: (x) => x },
                processor: (x) => x * 2
            };
            const res = processComplex(input);
            assert(res === 20, `processComplex(...) = ${res}`);
        } catch (e) { assert(false, `processComplex error: ${e.message}`); }

        try {
            const mixed = createMixed();
            const res = callMixed(mixed, 10);
            assert(res === 142, `Mixed Wasm/JS Callbacks = ${res}`);
        } catch (e) { assert(false, `Mixed error: ${e.message}`); }
    </script>
</body>
</html>
