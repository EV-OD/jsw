<!DOCTYPE html>
<html lang="en">
<head>
    <script type="module">
      import { add, factorial, normalJS, greet, addInt, sumArray, doubleArray, addPoints, processOuter, sumMatrix, transformPoints } from '/src/index.ts';
      import { multiplyMatrix } from '/src/matrix.ts';
      
      console.log('Running tests from browser...');

      function assert(actual, expected, message) {
          const actualStr = JSON.stringify(actual);
          const expectedStr = JSON.stringify(expected);
          const passed = actualStr === expectedStr;
          const status = passed ? '<span style="color:green">✅ PASS</span>' : '<span style="color:red">❌ FAIL</span>';
          
          console.log(`${passed ? 'PASS' : 'FAIL'}: ${message}`);
          if (!passed) {
              console.log(`  Expected: ${expectedStr}`);
              console.log(`  Actual:   ${actualStr}`);
          }

          document.body.innerHTML += `
            <div style="margin-bottom: 10px; border-bottom: 1px solid #eee; padding-bottom: 5px;">
                <strong>${message}</strong><br>
                Result: ${actualStr} <br>
                ${status}
            </div>
          `;
      }

      // Basic Types
      assert(add(10, 20), 200, 'add(10, 20) [should be 200 (10*20)]');
      assert(factorial(5), 120, 'factorial(5)');
      assert(normalJS(5), 10, 'normalJS(5)');
      assert(greet("World"), "Hello, World", 'greet("World")');
      assert(addInt(5, 7), 12, 'addInt(5, 7)');

      // Arrays
      assert(sumArray([1, 2, 3, 4, 5]), 15, 'sumArray([1, 2, 3, 4, 5])');
      assert(doubleArray([1, 2, 3]), [2, 4, 6], 'doubleArray([1, 2, 3])');

      // Objects
      const p1 = { x: 10, y: 20 };
      const p2 = { x: 5, y: 5 };
      const p3 = addPoints(p1, p2);
      assert(p3, { x: 15, y: 25 }, 'addPoints({x:10, y:20}, {x:5, y:5})');

      // Nested Objects
      const outer = {
        name: "Test",
        inner: { val: 42 },
        list: [1, 2, 3]
      };
      const processed = processOuter(outer);
      assert(processed, {
          name: "Processed Test",
          inner: { val: 43 },
          list: [2, 4, 6]
      }, 'processOuter(...)');

      // Matrix Multiplication
      const m1 = {
        rows: 2,
        cols: 2,
        data: [1, 2, 3, 4] 
      };
      const m2 = {
        rows: 2,
        cols: 2,
        data: [5, 6, 7, 8] 
      };
      const mResult = multiplyMatrix(m1, m2);
      assert(mResult, {
          rows: 2,
          cols: 2,
          data: [19, 22, 43, 50]
      }, 'multiplyMatrix(A, B)');

      // Nested Arrays
      const matrix = [[1, 2], [3, 4]];
      const matrixSum = sumMatrix(matrix);
      assert(matrixSum, 10, 'sumMatrix([[1, 2], [3, 4]])');

      // Array of Objects
      const points = [{x: 1, y: 1}, {x: 2, y: 2}];
      const transformedPoints = transformPoints(points);
      assert(transformedPoints, [{x: 2, y: 2}, {x: 4, y: 4}], 'transformPoints(...)');

    </script>
</head>
<body>
    <h2>JSW Automated Tests</h2>
</body>
</html>
